<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#ffffff" />
  <title>新年のご挨拶（教職員向けおみくじ）</title>
  <style>
    :root{
      --bg1:#fff6f1;   /* peach */
      --bg2:#f2fbff;   /* sky */
      --bg3:#f5fff0;   /* mint */
      --card:#ffffff;
      --ink:#1a2a3a;
      --muted:#516274;
      --line:rgba(17, 34, 51, .12);

      --accent:#ff7aa2; /* pink */
      --accent2:#3bb6ff;/* blue */
      --accent3:#2ed3a3;/* green */
      --gold:#ffb200;

      --shadow: 0 16px 40px rgba(17,34,51,.10);
      --radius: 18px;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI",
        "Hiragino Kaku Gothic ProN", "Noto Sans JP", Meiryo, sans-serif;
      color:var(--ink);
      background:
        radial-gradient(900px 600px at 15% 18%, rgba(255,122,162,.22), transparent 58%),
        radial-gradient(900px 600px at 82% 16%, rgba(59,182,255,.22), transparent 58%),
        radial-gradient(900px 700px at 50% 92%, rgba(46,211,163,.18), transparent 62%),
        linear-gradient(135deg, var(--bg1), var(--bg2) 45%, var(--bg3));
      min-height:100svh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:26px 14px;
    }

    a{color:var(--accent2)}
    .wrap{width:min(1040px, 100%);}

    .card{
      background: var(--card);
      border:1px solid var(--line);
      box-shadow: var(--shadow);
      border-radius: var(--radius);
      overflow:hidden;
    }

    .top{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:18px 20px;
      background: linear-gradient(90deg,
        rgba(255,122,162,.20),
        rgba(59,182,255,.18),
        rgba(46,211,163,.16)
      );
      border-bottom:1px solid var(--line);
    }

    .title{
      display:flex;
      flex-direction:column;
      gap:4px;
    }

    .title h1{
      margin:0;
      font-size:20px;
      letter-spacing:.02em;
    }
    .title .sub{
      margin:0;
      color:var(--muted);
      font-size:13px;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:10px 12px;
      border-radius:999px;
      background: rgba(255,255,255,.75);
      border:1px solid rgba(17,34,51,.14);
      font-size:12px;
      color:rgba(26,42,58,.92);
      white-space:nowrap;
    }
    .pill .spark{
      width:10px;height:10px;border-radius:50%;
      background: radial-gradient(circle at 30% 30%, #fff, var(--gold));
      box-shadow: 0 0 0 5px rgba(255,178,0,.18);
    }

    .grid{
      display:grid;
      grid-template-columns: 1.15fr .85fr;
      gap:16px;
      padding:18px;
    }
    @media (max-width: 900px){
      .grid{grid-template-columns:1fr}
    }

    .inner{
      background: rgba(255,255,255,.72);
      border:1px solid rgba(17,34,51,.10);
      border-radius: 16px;
      padding:18px;
    }

    .section-title{
      display:flex;
      align-items:center;
      gap:10px;
      margin:0 0 10px 0;
      font-size:15px;
      letter-spacing:.02em;
    }

    .badge{
      display:inline-flex;
      align-items:center;
      gap:6px;
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      background: rgba(59,182,255,.12);
      border:1px solid rgba(59,182,255,.20);
      color:rgba(26,42,58,.92);
    }

    .message p{
      margin:0;
      line-height:1.85;
      color:rgba(26,42,58,.92);
    }
    .muted{color:var(--muted)}
    .hr{
      height:1px;
      background: rgba(17,34,51,.12);
      margin:14px 0;
    }

    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }

    .input{
      display:flex;
      gap:8px;
      align-items:center;
      background: rgba(255,255,255,.85);
      border:1px solid rgba(17,34,51,.14);
      padding:10px 12px;
      border-radius: 12px;
      flex: 1 1 240px;
    }
    .input label{
      font-size:12px;
      color:var(--muted);
      white-space:nowrap
    }
    .input input{
      width:100%;
      border:none;
      outline:none;
      background: transparent;
      color: var(--ink);
      font-size:14px;
    }

    .btn{
      appearance:none;
      border:none;
      cursor:pointer;
      padding:12px 14px;
      border-radius: 14px;
      font-weight: 750;
      color:#fff;
      background: linear-gradient(90deg, var(--accent), #ffb4ca);
      box-shadow: 0 12px 26px rgba(255,122,162,.22);
      transition: transform .08s ease, filter .15s ease;
    }
    .btn:active{transform: translateY(1px) scale(.99)}
    .btn.blue{
      background: linear-gradient(90deg, var(--accent2), #9bdeff);
      box-shadow: 0 12px 26px rgba(59,182,255,.18);
    }
    .btn.green{
      background: linear-gradient(90deg, var(--accent3), #aef2df);
      box-shadow: 0 12px 26px rgba(46,211,163,.18);
    }
    .btn.ghost{
      color:rgba(26,42,58,.92);
      background: rgba(255,255,255,.86);
      border:1px solid rgba(17,34,51,.14);
      box-shadow:none;
      font-weight:700;
    }

    .hint{
      margin:0;
      font-size:12px;
      color:var(--muted);
      line-height:1.6;
    }

    .result{
      position:relative;
      background: rgba(255,255,255,.92);
      border:1px solid rgba(17,34,51,.12);
      border-radius: 16px;
      padding:14px;
      min-height: 200px;
      overflow:hidden;
    }

    .result .big{
      margin:0 0 6px 0;
      font-size:28px;
      font-weight:900;
      letter-spacing:.04em;
    }

    .gradtext{
      background: linear-gradient(90deg, var(--accent), var(--accent2), var(--accent3));
      -webkit-background-clip: text;
      background-clip:text;
      color:transparent;
    }

    .result .lead{
      margin:0;
      line-height:1.75;
      color:rgba(26,42,58,.92);
    }

    .cards{
      display:grid;
      grid-template-columns:1fr;
      gap:10px;
      margin-top:12px;
    }
    .mini{
      background: rgba(59,182,255,.08);
      border:1px solid rgba(59,182,255,.18);
      border-radius: 14px;
      padding:10px 12px;
    }
    .mini.pink{
      background: rgba(255,122,162,.08);
      border-color: rgba(255,122,162,.18);
    }
    .mini.green{
      background: rgba(46,211,163,.08);
      border-color: rgba(46,211,163,.18);
    }

    .mini .k{
      margin:0 0 4px 0;
      font-size:12px;
      color:rgba(26,42,58,.82);
      font-weight:800;
      letter-spacing:.02em;
    }
    .mini .v{
      margin:0;
      font-size:13px;
      line-height:1.7;
      color:rgba(26,42,58,.92);
    }

    .chips{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-top:10px;
    }
    .chip{
      font-size:12px;
      padding:6px 10px;
      border-radius:999px;
      background: rgba(17,34,51,.04);
      border:1px solid rgba(17,34,51,.10);
      color:rgba(26,42,58,.92);
    }

    .toggle{
      display:flex;
      align-items:center;
      gap:8px;
      padding:10px 12px;
      border-radius:12px;
      background: rgba(255,255,255,.86);
      border:1px solid rgba(17,34,51,.14);
    }
    .toggle input{transform: translateY(1px);}
    .toggle span{font-size:12px;color:var(--muted)}

    /* confetti (light) */
    canvas.confetti{
      position:absolute;
      inset:0;
      pointer-events:none;
      opacity:0;
    }
    canvas.confetti.on{opacity:1}

    footer{
      margin-top:12px;
      text-align:center;
      color:rgba(81,98,116,.95);
      font-size:12px;
    }

    /* small header illustration */
    .mark{
      display:flex;
      align-items:center;
      gap:10px;
    }
    .logo{
      width:34px;height:34px;border-radius:12px;
      background: linear-gradient(135deg, rgba(255,122,162,.35), rgba(59,182,255,.30), rgba(46,211,163,.28));
      border:1px solid rgba(17,34,51,.12);
      display:grid;place-items:center;
    }
    .logo svg{opacity:.95}
  </style>
</head>

<body>
  <main class="wrap">
    <section class="card">
      <div class="top">
        <div class="mark">
          <div class="logo" aria-hidden="true">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
              <path d="M7 10c3-6 7-6 10 0" stroke="rgba(26,42,58,.85)" stroke-width="2" stroke-linecap="round"/>
              <path d="M6 12c2 3 4 4 6 4s4-1 6-4" stroke="rgba(26,42,58,.85)" stroke-width="2" stroke-linecap="round"/>
              <circle cx="9" cy="10" r="1.2" fill="rgba(26,42,58,.85)"/>
              <circle cx="15" cy="10" r="1.2" fill="rgba(26,42,58,.85)"/>
            </svg>
          </div>
          <div class="title">
            <h1>新年のご挨拶（教職員のみなさまへ）</h1>
            <p class="sub" id="dateLine">—</p>
          </div>
        </div>
        <div class="pill" title="おみくじは“先生の仕事の元気が出る”方向に寄せています（説教くささゼロ）">
          <span class="spark"></span>
          <span>モチベUPおみくじ</span>
        </div>
      </div>

      <div class="grid">
        <!-- left -->
        <div class="inner message">
          <h2 class="section-title">
            ごあいさつ
            <span class="badge">年賀状がわり</span>
          </h2>

          <!-- ▼ここをあなたの文面に書き換えOK▼ -->
          <p class="muted" style="margin:0 0 6px 0;">To: 教職員のみなさま</p>
          <p>
            あけましておめでとうございます。<br>
            旧年中はさまざまな場面で支えていただき、ありがとうございました。<br>
            本年も、生徒たちの成長のために、力を合わせて歩んでいければうれしいです。
          </p>
          <p style="margin-top:10px">
            右側に <b>「教職員向けおみくじ」</b> を用意しました。<br>
            授業・生徒対応・チーム連携・自分のケアのヒントが出ます。よかったらどうぞ。
          </p>
          <!-- ▲ここまで▲ -->

          <div class="hr"></div>

          <div class="row">
            <div class="input">
              <label for="name">お名前（任意）</label>
              <input id="name" placeholder="例：井上 / 山田 / Kenji" autocomplete="off" />
            </div>
            <button class="btn ghost" id="applyName">名前を反映</button>
          </div>

          <p class="hint" id="personalLine">—</p>

          <div class="row" style="margin-top:6px">
            <button class="btn blue" id="copyLink">URLをコピー</button>
            <button class="btn ghost" id="shareLink">共有（スマホ対応）</button>
          </div>
          <p class="hint">※ URLに <code>?name=〇〇</code> を付けると、名前入りリンクになります。</p>
        </div>

        <!-- right -->
        <div class="inner">
          <h2 class="section-title">おみくじ（先生の仕事モード）</h2>
          <p class="hint" style="margin-top:-6px">
            「今日の結果を固定」をONにすると、<b>1日1回</b>の“朝のスイッチ”として使えます。
          </p>

          <div class="row" style="margin-top:10px">
            <label class="toggle" title="ONだと当日中は同じ結果を表示します">
              <input type="checkbox" id="lockToday" checked />
              <span>今日の結果を固定（1日1回）</span>
            </label>
            <button class="btn ghost" id="reset">リセット</button>
          </div>

          <div style="height:10px"></div>

          <div class="result" aria-live="polite">
            <canvas class="confetti" id="confetti"></canvas>
            <p class="big gradtext" id="fortuneBig">まだ引いていません</p>
            <p class="lead" id="fortuneLead">「おみくじを引く」を押すと、今日のヒントが出ます。</p>

            <div class="cards" id="cards" style="display:none">
              <div class="mini pink">
                <p class="k">今日のミニ目標</p>
                <p class="v" id="goal">—</p>
              </div>
              <div class="mini">
                <p class="k">授業・学級のヒント</p>
                <p class="v" id="classHint">—</p>
              </div>
              <div class="mini green">
                <p class="k">生徒対応のひと言</p>
                <p class="v" id="studentHint">—</p>
              </div>
              <div class="mini">
                <p class="k">チーム連携</p>
                <p class="v" id="teamHint">—</p>
              </div>
              <div class="mini green">
                <p class="k">自分へのケア</p>
                <p class="v" id="selfCare">—</p>
              </div>
              <div class="mini pink">
                <p class="k">自分へのねぎらい</p>
                <p class="v" id="praise">—</p>
              </div>
            </div>

            <div class="chips" id="chips" style="display:none"></div>
          </div>

          <div class="row" style="margin-top:12px">
            <button class="btn green" id="draw">おみくじを引く</button>
            <button class="btn ghost" id="copyResult">結果をコピー</button>
          </div>

          <p class="hint" style="margin-top:10px">
            ※ 外部通信なしで動作します（校内ネットワークでも表示しやすい構成）。
          </p>
        </div>
      </div>
    </section>

    <footer>
      <span id="footerYear">—</span> / HTML + CSS + JavaScript（1ファイル）
    </footer>
  </main>

<script>
(() => {
  // ===== 日付表示 =====
  const now = new Date();
  const y = now.getFullYear();
  const m = now.getMonth() + 1;
  const d = now.getDate();
  const w = ["日","月","火","水","木","金","土"][now.getDay()];
  document.getElementById("dateLine").textContent = `${y}年${m}月${d}日（${w}）`;
  document.getElementById("footerYear").textContent = `© ${y}`;

  // ===== パーソナライズ =====
  const nameInput = document.getElementById("name");
  const personalLine = document.getElementById("personalLine");
  const applyName = document.getElementById("applyName");

  function setPersonalLine(name){
    if(!name){
      personalLine.textContent = "（お名前を入れると、メッセージが少しだけパーソナライズされます）";
      return;
    }
    personalLine.textContent = `${name} さんへ：今年も、軽やかに。良い一年になりますように。`;
  }

  const params = new URLSearchParams(location.search);
  const initialName = params.get("name") || "";
  if(initialName){
    nameInput.value = initialName;
    setPersonalLine(initialName);
  }else{
    setPersonalLine("");
  }

  applyName.addEventListener("click", () => {
    const name = nameInput.value.trim();
    setPersonalLine(name);
    const u = new URL(location.href);
    if(name) u.searchParams.set("name", name);
    else u.searchParams.delete("name");
    history.replaceState(null, "", u.toString());
  });

  // ===== 共有/コピー =====
  const copyBtn = document.getElementById("copyLink");
  copyBtn.addEventListener("click", async () => {
    try{
      await navigator.clipboard.writeText(location.href);
      copyBtn.textContent = "コピーしました！";
      setTimeout(() => copyBtn.textContent = "URLをコピー", 1200);
    }catch(e){
      alert("コピーできませんでした。URLを手動でコピーしてください。");
    }
  });

  const shareBtn = document.getElementById("shareLink");
  shareBtn.addEventListener("click", async () => {
    try{
      if(navigator.share){
        await navigator.share({
          title: document.title,
          text: "新年のご挨拶（教職員向けおみくじ）",
          url: location.href
        });
      }else{
        alert("この端末は共有機能に未対応です。『URLをコピー』をご利用ください。");
      }
    }catch(e){}
  });

  // ===== おみくじ（教職員向け / 凶なし / 説教なし） =====
  const fortunes = [
    {title:"大吉", weight: 18, lead:"いい流れ。今日は『軽やかに一歩』がはまりやすい日。"},
    {title:"中吉", weight: 34, lead:"安定の追い風。いつもの段取りがちゃんと味方してくれます。"},
    {title:"小吉", weight: 30, lead:"じわじわ良い日。小さな工夫が、後から効いてきます。"},
    {title:"吉",   weight: 18, lead:"ちょうどいい日。頑張りすぎず、整えながら進めばOK。"}
  ];

  const goals = [
    "今日は“負担が軽い”仕事を1つ片づけて、気分の余白を作る。",
    "授業の冒頭で、笑える小ネタを1つだけ入れてみる。",
    "生徒の“よかったところ”を、1人だけ具体的に言葉にする。",
    "職員室で会った人に、ひとことプラスの挨拶を添える。",
    "やることを1つだけ減らす（明日でもいいものを明日に回す）。",
    "放課後の予定を守るために、今日の締め切りを1つだけ早める。",
    "帰り道に寄り道できる余力を残す（5分早く出られたら勝ち）。"
  ];

  const classHints = [
    "『今日のゴールはこれ』を一言で置くと、授業が軽く回ります。",
    "板書（スライド）を“3点セット”にする：結論／理由／例。",
    "発問は“短く”→理由は後から。場が温まってから深掘りでOK。",
    "テンポが落ちたら、1分だけペア相談。空気が戻りやすいです。",
    "最後に『今日いちばん残った言葉』を回収すると、余韻が残ります。"
  ];

  const studentHints = [
    "今日は“聞く日”でもOK。短い相づちだけで十分届くことがあります。",
    "生徒の言葉を1回だけ言い換えて返すと、会話がすっと進みやすい。",
    "困りごとは“いま”と“次”に分けると、負担が軽くなります。",
    "正解探しより、選択肢を2つ用意する感じで。本人が選べると前に進みます。",
    "小さな進歩を拾う日。『そこできたのいいね』が効きます。"
  ];

  const teamHints = [
    "共有は短文でOK：『結論→次→期限』の3つだけで十分伝わります。",
    "頼みごとは“相手の都合を聞く一言”があると、空気が柔らかくなります。",
    "今日は“助けを借りる日”でもOK。早めに言うほどラクになります。",
    "雑談の一言が、仕事の連携をスムーズにします（本当に）。",
    "困りごとを“見える化”すると、チームの安心感が上がります。"
  ];

  const selfCares = [
    "仕事は生活の一部。今日は“自分のリズム”を守る方を優先で。",
    "休憩は短くても効きます。1分だけ立って肩を回すだけでもOK。",
    "『今日はここまで』の線引きができたら、それは勝ちです。",
    "完璧じゃなくて大丈夫。心地よく続けられる形がいちばん強い。",
    "帰宅後の楽しみを1つ確保する（小さくていい、あるだけで強い）。"
  ];

  const praises = [
    "今日も現場を回している時点で、十分すごいです。",
    "あなたの“気づき”が、生徒の安心につながっています。",
    "丁寧に見ていることは、ちゃんと伝わっています。",
    "うまくいった点、きっとあります。見つけられるのは強さです。",
    "背負いすぎない工夫ができたら、それも立派な仕事です。"
  ];

  const tags = [
    "ゆるくいこう", "余白づくり", "現場あるある", "小さな工夫",
    "声かけ", "整える", "チームで回す", "生活ファースト"
  ];

  function pick(arr){
    return arr[Math.floor(Math.random() * arr.length)];
  }

  function pickWeighted(items){
    const total = items.reduce((s,x)=>s + x.weight, 0);
    let r = Math.random() * total;
    for(const it of items){
      r -= it.weight;
      if(r <= 0) return it;
    }
    return items[items.length-1];
  }

  // ===== UI DOM =====
  const lockToday = document.getElementById("lockToday");
  const drawBtn = document.getElementById("draw");
  const resetBtn = document.getElementById("reset");
  const copyResultBtn = document.getElementById("copyResult");

  const fortuneBig = document.getElementById("fortuneBig");
  const fortuneLead = document.getElementById("fortuneLead");
  const cards = document.getElementById("cards");

  const goal = document.getElementById("goal");
  const classHint = document.getElementById("classHint");
  const studentHint = document.getElementById("studentHint");
  const teamHint = document.getElementById("teamHint");
  const selfCare = document.getElementById("selfCare");
  const praise = document.getElementById("praise");

  const chipsWrap = document.getElementById("chips");

  // ===== confetti =====
  const canvas = document.getElementById("confetti");
  const ctx = canvas.getContext("2d");
  let raf = null;

  function burstConfetti(){
    const parent = canvas.parentElement;
    const rect = parent.getBoundingClientRect();
    canvas.width = Math.max(1, Math.floor(rect.width));
    canvas.height = Math.max(1, Math.floor(rect.height));
    canvas.classList.add("on");

    const palette = [
      "rgba(255,122,162,.85)",
      "rgba(59,182,255,.85)",
      "rgba(46,211,163,.85)",
      "rgba(255,178,0,.85)"
    ];

    const pieces = Array.from({length: 95}, () => ({
      x: Math.random()*canvas.width,
      y: -20 - Math.random()*canvas.height*0.25,
      vy: 1.6 + Math.random()*3.2,
      vx: -1.4 + Math.random()*2.8,
      r: 2 + Math.random()*5,
      a: 0.75 + Math.random()*0.25,
      rot: Math.random()*Math.PI,
      c: palette[Math.floor(Math.random()*palette.length)]
    }));

    let frames = 0;
    const maxFrames = 85;

    const tick = () => {
      frames++;
      ctx.clearRect(0,0,canvas.width,canvas.height);

      for(const p of pieces){
        p.x += p.vx;
        p.y += p.vy;
        p.rot += 0.16;

        ctx.save();
        ctx.globalAlpha = p.a;
        ctx.translate(p.x, p.y);
        ctx.rotate(p.rot);
        ctx.fillStyle = p.c;
        ctx.fillRect(-p.r, -p.r, p.r*2, p.r*1.35);
        ctx.restore();
      }

      if(frames < maxFrames){
        raf = requestAnimationFrame(tick);
      }else{
        canvas.classList.remove("on");
        ctx.clearRect(0,0,canvas.width,canvas.height);
      }
    };

    if(raf) cancelAnimationFrame(raf);
    tick();
  }

  // ===== 保存（1日固定用） =====
  const todayKey = () => {
    const t = new Date();
    const yyyy = t.getFullYear();
    const mm = String(t.getMonth()+1).padStart(2,"0");
    const dd = String(t.getDate()).padStart(2,"0");
    return `${yyyy}-${mm}-${dd}`;
  };

  const STORE_KEY = "school_staff_omikuji_v2";

  function loadSaved(){
    try{
      const s = JSON.parse(localStorage.getItem(STORE_KEY) || "null");
      return s;
    }catch(e){ return null; }
  }

  function saveResult(payload){
    localStorage.setItem(STORE_KEY, JSON.stringify(payload));
  }

  function clearSaved(){
    localStorage.removeItem(STORE_KEY);
  }

  function renderResult(payload){
    fortuneBig.textContent = payload.f.title;
    fortuneLead.textContent = payload.f.lead;

    goal.textContent = payload.goal;
    classHint.textContent = payload.classHint;
    studentHint.textContent = payload.studentHint;
    teamHint.textContent = payload.teamHint;
    selfCare.textContent = payload.selfCare;
    praise.textContent = payload.praise;

    cards.style.display = "grid";
    chipsWrap.style.display = "flex";
    chipsWrap.innerHTML = "";
    for(const c of payload.chips){
      const el = document.createElement("span");
      el.className = "chip";
      el.textContent = c;
      chipsWrap.appendChild(el);
    }

    // 演出：大吉/中吉のときだけ
    if(payload.f.title === "大吉" || payload.f.title === "中吉"){
      burstConfetti();
    }
  }

  function makePayload(){
    const f = pickWeighted(fortunes);
    const chips = Array.from({length: 4}, () => pick(tags));

    return {
      day: todayKey(),
      f,
      goal: pick(goals),
      classHint: pick(classHints),
      studentHint: pick(studentHints),
      teamHint: pick(teamHints),
      selfCare: pick(selfCares),
      praise: pick(praises),
      chips
    };
  }

  function applyTodayLockState(){
    const saved = loadSaved();
    const locked = lockToday.checked;

    if(locked && saved && saved.day === todayKey()){
      renderResult(saved);
      drawBtn.textContent = "今日はもう引きました";
      drawBtn.disabled = true;
      drawBtn.style.filter = "grayscale(.25) opacity(.85)";
      return;
    }

    drawBtn.disabled = false;
    drawBtn.textContent = "おみくじを引く";
    drawBtn.style.filter = "";
  }

  lockToday.addEventListener("change", () => {
    applyTodayLockState();
  });

  drawBtn.addEventListener("click", () => {
    const payload = makePayload();
    renderResult(payload);

    if(lockToday.checked){
      saveResult(payload);
      applyTodayLockState();
    }
  });

  resetBtn.addEventListener("click", () => {
    clearSaved();
    fortuneBig.textContent = "まだ引いていません";
    fortuneLead.textContent = "「おみくじを引く」を押すと、今日のヒントが出ます。";
    cards.style.display = "none";
    chipsWrap.style.display = "none";
    chipsWrap.innerHTML = "";
    applyTodayLockState();
  });

  copyResultBtn.addEventListener("click", async () => {
    const title = fortuneBig.textContent || "おみくじ";
    const lead = fortuneLead.textContent || "";

    const lines = [
      `【教職員おみくじ】${title}`,
      lead,
      "",
      `■今日のミニ目標：${goal.textContent || ""}`,
      `■授業・学級：${classHint.textContent || ""}`,
      `■生徒対応：${studentHint.textContent || ""}`,
      `■チーム連携：${teamHint.textContent || ""}`,
      `■自分へのケア：${selfCare.textContent || ""}`,
      `■ねぎらい：${praise.textContent || ""}`,
      "",
      `（${location.href}）`
    ].join("\n");

    try{
      await navigator.clipboard.writeText(lines);
      copyResultBtn.textContent = "結果をコピーしました！";
      setTimeout(() => copyResultBtn.textContent = "結果をコピー", 1200);
    }catch(e){
      alert("コピーできませんでした。");
    }
  });

  // 初期表示
  applyTodayLockState();
})();
</script>
</body>
</html>
